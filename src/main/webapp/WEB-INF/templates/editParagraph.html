<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" th:replace="common-scripts :: css-bootstrap" href="../../css/bootstrap-3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" th:replace="common-scripts :: jquery-ui-css" href="../../css/jquery-ui-1.12.1.min.css">

    <script type="text/javascript" th:replace="common-scripts :: jquery" src="../../js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" th:replace="common-scripts :: jquery-ui" src="../../js/jquery-ui-1.12.1.min.js"></script>
    <script type="text/javascript" th:replace="common-scripts :: functions" src="../../js/functions.js"></script>
    <script type="text/javascript" th:replace="common-scripts :: icon-selector" src="../../js/icon-selector.js"></script>

    <script type="text/javascript">
        focusOnLoad('#name');
    </script>
    <script th:inline="javascript">
        $( function() {
            /*<![CDATA[*/
            iconSelector({
                iconSelectorContainerId: 'icon-container',
                onIconDelete: function () {removeIcon();},
                attrName: "iconId",
                initIconId: /*[[${form.iconId}]]*/
            });
            /*]]>*/
            $( function() {
                $( "#dialog-confirm" ).dialog({
                    resizable: false,
                    height: "auto",
                    width: 400,
                    modal: true,
                    autoOpen: false
                });
                document.onpaste = function(event){
                    uploadImage({
                        imageType: isWaitingForIcon('icon-container') ? 'ICON' : 'UNKNOWN_IMAGE_TYPE',
                        file: extractFileFromEvent(event),
                        onSuccess: function (imgId) {
                            if (isWaitingForIcon('icon-container')) {
                                setIcon('icon-container', imgId)
                            } else {
                                alert("Error E0571.")
                            }
                        }
                    })
                };
            } );
        } );
        function removeIcon() {
            confirmCancelDialog("dialog-confirm", "Delete icon?", "Delete", function () {
                unsetIcon('icon-container');
            });
        }
    </script>
</head>
<body>
<div th:replace="path :: path"/>
<form th:action="${(#mvc.url('NC#editParagraphPost')).build()}" th:object="${form}" method="post">
    <input type="hidden" th:field="*{parentId}"/>
    <input type="hidden" th:field="*{id}"/>
    <table>
        <tr>
            <td>Name</td>
            <td><input id="name" type="text" th:field="*{name}" size="120"/></td>
        </tr>
        <tr>
            <td>SOL</td>
            <td><input id="sol" th:type="checkbox" th:field="*{sol}" th:checked="*{sol}"/></td>
        </tr>
        <tr>
            <td>Icon</td>
            <td id="icon-container" ></td>
        </tr>
        <tr>
            <td><a th:href="@{paragraph(id=${form.idToRedirectToIfCancelled})}">Cancel</a></td>
            <td><input type="submit" th:value="*{id} == null ? 'Create' : 'Save'" value="Save"/></td>
        </tr>
    </table>
</form>

<div id="dialog-confirm" hidden="hidden">
</div>

</body>
</html>
